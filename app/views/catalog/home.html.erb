<% title "OpenVault - Home" %>
<h2 id="welcome-header" class="t-center">Welcome to the WGBH Media Library &amp; Archives OpenVault</h2>
<p id="welcome-text" class="hidden-phone">We provide online access to unique and historically important content produced by the public television and radio station WGBH. The ever-expanding site contains video, audio, images, searchable transcripts, and resource management tools, all of which are available for individual and classroom learning. For over 25 years the MLA has preserved, cataloged, and provided access to materials produced by WGBH. It currently houses nearly 1 million audio, video, film, and digital assets dating back to 1947. So have a look around and explore!</p>

<div class="row-fluid">
  <div id="exhibits" class="grainbox span8">
    <h2>Exhibits</h2>
    <div class="sep-line"></div>
    <div id="exhibit-slider">
      <% @collections.each_with_index do |ex, idx| %>
        <div class="exhibit-item <%= (idx == 0) ? 'active' : '' %> row-fluid" item-num="<%= idx %>">
          <div class="text span6">
            <h3><%= ex.name %></h3>
            <div class="summary hidden-tablet hidden-phone">
              <p><%= truncate(ex.summary, length: 720).html_safe %></p>
            </div>
            <div class="summary-tablet hidden-desktop hidden-phone">
              <p><%= truncate(ex.summary, length: 300).html_safe %></p>
            </div>
            <div class="link hidden-phone">
              <a href="/collection/<%= ex.slug %>">View exhibit</a>
            </div>
          </div>
          <div class="image span6">
            <%= link_to image_tag(ex.image.carousel.url), "/collection/#{ex.slug}" %>
          </div>
        </div>
      <% end %>
    </div>
    <div class="clearfix"></div>
    <div id="exhibit-controls">
      <% @collections.length.times do |idx| %>
        <a href="#" data-num="<%= idx %>" class="<%= (idx == 0) ? 'active' : '' %> page-dot"></a>
      <% end %>
    </div>
  </div>
  <div id="collections" class="grainbox span4">
    <h2>New Collections</h2>
    <div class="sep-line"></div>
    <% @custom_collections.each do |coll| %>
      <div class="collection_block">
        <h3><%= link_to coll.name, coll.user.url %></h3>
        <img src="<%= coll.user.avatar.url(:thumb) %>" class="user_img">
        <div class="user_bio">
          <p><%= coll.user.full_name %> - <%= coll.user.work_string %></p>
          <%= link_to "View", coll.user.url %>
        </div>
      </div>
    <% end %>
  </div>
</div>

<div id="catalog-scroller" class="row-fluid">
  <!-- <div class="shadow-left"></div> -->
  <div id="scroller-items">
    <% @scroller_items.each do |item| %>
      <a href="/video/<%= item[1].to_s %>" class="scroller-item">
        <img src="<%= item[0].to_s %>" class="scroller-image" />
      </a>
    <% end %>
  </div>
  <!-- <div class="shadow-right"></div> -->
  <!-- <div id="tS2" class="jThumbnailScroller">
      <div class="jTscrollerContainer">
          <div class="jTscroller">
            <%# @scroller_items.each do |item| %>
              <a href="/video/<%#= item[1].to_s %>">
                <img src="<%#= item[0].to_s %>" class="scroller-image" />
              </a>
            <%# end %>
          </div>
      </div>
      <a href="#" class="jTscrollerPrevButton"></a>
      <a href="#" class="jTscrollerNextButton"></a>
  </div> -->
</div>

<div class="row-fluid">
  <div id="blog" class="span8">
    <h2>From the blog</h2>
    <div class="sep-line"></div>
    <div class="row-fluid">
      <div id="featured-post" class="span7">
        <% feature = Wordpress.get_post(:id => 1582) rescue nil %>
        <% if feature != nil %>
        <%= image_tag feature.images('thumbnail')['url'], alt: feature.title %>
        <h3><%= feature.title %></h3>
        <p><%= truncate(sanitize(feature.content, tags: %w{a, strong, em, p}) , :length => 800).html_safe %></p>
        <a href="<%= feature.url %>" class="action_link">Read more</a>
        <% else %>
        <p>We seem to be having a problem, please check back later.</p>
        <% end %>
      </div>
      <div id="more-posts" class="span5">
        <% posts = Wordpress.get_recent_posts(:count => 3) rescue nil %>
        <% posts.each do |post| %>
          <div class="post row-fluid">
          	<div class="body span12">
          		<h3><%= post.title %></h3>
          		<p><%= truncate(post.excerpt, :length => 180).html_safe %><a href="<%= post.url %>">Read more</a></p>
        		</div>
        	</div>
      	<% end rescue nil %>
        <% if posts != nil %>
          <a href="/blog" class="action_link" style="display:block;text-align:center;width:100%;">View all</a>
        <% end %>
      </div>
    </div>
  </div>
  <div id="tweets" class="span4">
    <h2>Recent Tweets</h2>
    <div class="sep-line"></div>
    <div id="tweet-list">
      <% unless @tweets.nil? %>
        <% @tweets.each_with_index do |tweet| %>
          <div class="tweet-item">
            <p><%= tweet.text %></p>
          </div>
        <% end %>
      <% end %>
      <% if @tweets.nil? || @tweets.empty? %>
        <p>There was a problem connecting to twitter, please check back later.</p>
      <% end %>
    </div>
    <a href="https://twitter.com/wgbharchives" class="twitter-follow">Follow @wgbharchives</a>
  </div>
</div>